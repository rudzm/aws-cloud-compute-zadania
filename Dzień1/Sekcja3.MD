### **Zadania praktyczne dla sekcji 3: Podstawowe usÅ‚ugi AWS (EC2, VPC, S3, EBS)**  

---

# **Amazon EC2**  
**Uruchomienie instancji EC2**  
- UtwÃ³rz nowÄ… instancjÄ™ EC2 z systemem **Amazon Linux 2**.  
- Wybierz **typu t3.micro** (Free Tier).  
- Skonfiguruj klucz SSH i poÅ‚Ä…cz siÄ™ z instancjÄ….  
- Zainstaluj serwer Apache i uruchom stronÄ™ testowÄ… (`sudo yum install httpd -y && sudo systemctl start httpd`). 

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

1. PrzejdÅº do **AWS Management Console** â†’ **EC2** â†’ **Launch Instance**.  
2. Wybierz **Amazon Linux 2 AMI**.  
3. Wybierz typ instancji **t3.micro** (Free Tier).  
4. Skonfiguruj **Security Group**, pozwalajÄ…c na **SSH (22), HTTP (80), HTTPS (443)**.  
5. Przypisz klucz SSH i uruchom instancjÄ™.  
6. PoÅ‚Ä…cz siÄ™ przez SSH:  
   ```sh
   ssh -i MyKey.pem ec2-user@<public-ip>
   ```
7. Zainstaluj serwer Apache:  
   ```sh
   sudo yum install httpd -y
   sudo systemctl start httpd
   sudo systemctl enable httpd
   ```
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

```sh
aws ec2 run-instances --image-id ami-12345678 --count 1 --instance-type t3.micro \
  --key-name MyKeyPair --security-groups WebServerSG
```
</details>

---

# **Amazon VPC**  
**Tworzenie wÅ‚asnej sieci VPC**  
- UtwÃ³rz **nowe VPC** z adresem **10.0.0.0/16**.  
- Skonfiguruj **dwa subnety**:  
  - Publiczny subnet: `10.0.1.0/24` (dostÄ™p do Internetu).  
  - Prywatny subnet: `10.0.2.0/24` (bez dostÄ™pu do Internetu).  
- Skonfiguruj **Internet Gateway** dla publicznego subnetu.  
- Uruchom instancjÄ™ EC2 w prywatnym subnecie i skonfiguruj dostÄ™p przez **NAT Gateway**.  

<details>
  <summary>Instrukcja krok po kroku AWS GUI</summary>

  1. **Tworzenie VPC**  
    - PrzejdÅº do **AWS Management Console** â†’ **VPC** â†’ **Create VPC**.  
    - Nazwij VPC: `MyCustomVPC`.  
    - Ustaw **IPv4 CIDR**: `10.0.0.0/16`.  
    - Kliknij **Create VPC**.  
  2. **Tworzenie SubnetÃ³w**  
    - PrzejdÅº do **Subnets** â†’ **Create Subnet**.  
    - Wybierz `MyCustomVPC`.  
    - UtwÃ³rz **publiczny subnet** (`10.0.1.0/24`).  
    - UtwÃ³rz **prywatny subnet** (`10.0.2.0/24`).  
  3. **Tworzenie Internet Gateway (IGW)**  
    - PrzejdÅº do **Internet Gateways** â†’ **Create IGW**.  
    - Nazwij IGW: `MyInternetGateway`.  
    - Przypisz go do **MyCustomVPC** â†’ **Attach to VPC**.  
  4. **Konfiguracja Route Table dla Public Subnet**  
    - PrzejdÅº do **Route Tables** â†’ Wybierz domyÅ›lnÄ… tabelÄ™.  
    - Kliknij **Edit Routes** â†’ **Add Route**.  
    - Ustaw **Destination**: `0.0.0.0/0`.  
    - Wybierz **Target**: `MyInternetGateway`.  
    - **Save changes**. 

</details>
<details>
  <summary>Instrukcja krok po kroku AWS CLI</summary>

```sh
# Tworzenie VPC
aws ec2 create-vpc --cidr-block 10.0.0.0/16

# Tworzenie subnetÃ³w
aws ec2 create-subnet --vpc-id vpc-12345678 --cidr-block 10.0.1.0/24
aws ec2 create-subnet --vpc-id vpc-12345678 --cidr-block 10.0.2.0/24

# Tworzenie Internet Gateway
aws ec2 create-internet-gateway
aws ec2 attach-internet-gateway --vpc-id vpc-12345678 --internet-gateway-id igw-12345678

# Tworzenie Route Table i dodanie reguÅ‚y
aws ec2 create-route-table --vpc-id vpc-12345678
aws ec2 create-route --route-table-id rtb-12345678 --destination-cidr-block 0.0.0.0/0 --gateway-id igw-12345678
```

</details>

**Konfiguracja Security Groups i Network ACLs**  
- UtwÃ³rz **Security Group**, ktÃ³ra zezwala na ruch:  
  - `HTTP (80)` i `HTTPS (443)` dla wszystkich (`0.0.0.0/0`).  
  - `SSH (22)` tylko dla Twojego IP.  
- Skonfiguruj **Network ACLs**, blokujÄ…c caÅ‚y ruch spoza Twojego VPC.  

<details>
  <summary>Instrukcja krok po kroku AWS GUI</summary>

1. **Tworzenie Security Group dla EC2**  
   - PrzejdÅº do **EC2** â†’ **Security Groups** â†’ **Create Security Group**.  
   - **Name**: `WebServerSG`.  
   - **Inbound Rules**:  
     - **Allow HTTP (80)** â†’ `0.0.0.0/0`.  
     - **Allow HTTPS (443)** â†’ `0.0.0.0/0`.  
     - **Allow SSH (22)** â†’ **Your IP**.  

2. **Tworzenie Network ACL**  
   - PrzejdÅº do **VPC** â†’ **Network ACLs** â†’ **Create Network ACL**.  
   - Wybierz **MyCustomVPC**.  
   - **Inbound Rules**:  
     - Rule #100: **Allow HTTP (80)** â†’ `0.0.0.0/0`.  
     - Rule #110: **Allow HTTPS (443)** â†’ `0.0.0.0/0`.  
     - Rule #120: **Allow SSH (22)** â†’ **Your IP**.  
   - **Outbound Rules**:  
     - Rule #100: **Allow ALL Traffic** â†’ `0.0.0.0/0`. 

</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

```sh
# Tworzenie Security Group
aws ec2 create-security-group --group-name WebServerSG --description "Security Group for Web Server" --vpc-id vpc-12345678

# Dodanie reguÅ‚ do Security Group
aws ec2 authorize-security-group-ingress --group-name WebServerSG --protocol tcp --port 80 --cidr 0.0.0.0/0
aws ec2 authorize-security-group-ingress --group-name WebServerSG --protocol tcp --port 22 --cidr <your-ip>/32

# Tworzenie Network ACL
aws ec2 create-network-acl --vpc-id vpc-12345678

# Dodanie reguÅ‚ do Network ACL
aws ec2 create-network-acl-entry --network-acl-id acl-12345678 --rule-number 100 --protocol tcp --port-range From=80,To=80 --cidr-block 0.0.0.0/0 --rule-action allow
aws ec2 create-network-acl-entry --network-acl-id acl-12345678 --rule-number 110 --protocol tcp --port-range From=443,To=443 --cidr-block 0.0.0.0/0 --rule-action allow
```

</details>

**PoÅ‚Ä…czenie dwÃ³ch instancji EC2 w rÃ³Å¼nych subnetach**  
- Uruchom dwie instancje EC2 w rÃ³Å¼nych subnetach tej samej VPC.  
- Skonfiguruj trasowanie w tabeli routingu, aby mogÅ‚y siÄ™ komunikowaÄ‡.  
- Przetestuj poÅ‚Ä…czenie za pomocÄ… `ssh`.  


<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

1. **Uruchomienie dwÃ³ch instancji EC2**  
   - PrzejdÅº do **EC2** â†’ **Launch Instance**.  
   - Wybierz **Amazon Linux 2**.  
   - **Publiczna instancja** â†’ **PublicSubnet**, wÅ‚Ä…cz **Auto-assign Public IP**.  
   - **Prywatna instancja** â†’ **PrivateSubnet**, wyÅ‚Ä…cz **Auto-assign Public IP**.  
   - Wybierz **WebServerSG**.  

2. **PoÅ‚Ä…czenie miÄ™dzy instancjami**  
   - PoÅ‚Ä…cz siÄ™ z **publicznÄ… instancjÄ…**:  
     ```sh
     ssh -i MyKey.pem ec2-user@<public-ip>
     ```
   - SprawdÅº **Private IP** drugiej instancji.  
   - PoÅ‚Ä…cz siÄ™ do niej z publicznej instancji:  
     ```sh
     ssh ec2-user@<private-ip>
     ```

</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

```sh
# Uruchomienie publicznej instancji
aws ec2 run-instances --image-id ami-12345678 --count 1 --instance-type t3.micro --subnet-id subnet-12345678 --key-name MyKey --security-groups WebServerSG

# Uruchomienie prywatnej instancji
aws ec2 run-instances --image-id ami-12345678 --count 1 --instance-type t3.micro --subnet-id subnet-87654321 --key-name MyKey --security-groups WebServerSG
```
</details>

---

# **Amazon EBS**  
**Tworzenie i podÅ‚Ä…czanie woluminu EBS do EC2**  
- UtwÃ³rz **wolumin EBS** o pojemnoÅ›ci **10 GB**.  
- PodÅ‚Ä…cz go do istniejÄ…cej instancji EC2.  
- Sformatuj dysk (`mkfs -t xfs /dev/xvdf`) i zamontuj (`mount /dev/xvdf /mnt`).  
- Zapisz plik testowy i sprawdÅº, czy dane sÄ… przechowywane po restarcie instancji. 

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

### **1. Tworzenie woluminu EBS**  
1. PrzejdÅº do **AWS Management Console** â†’ **EC2 Dashboard**.  
2. W menu bocznym kliknij **Volumes** (sekcja "Elastic Block Store").  
3. Kliknij **Create Volume**.  
4. Skonfiguruj wolumin:  
   - **Size (GB)**: `10` (lub wiÄ™cej, wedÅ‚ug potrzeb).  
   - **Volume Type**: `gp3` (General Purpose SSD).  
   - **Availability Zone**: Wybierz **tÄ™ samÄ… AZ**, w ktÃ³rej dziaÅ‚a Twoja instancja EC2.  
   - **Encryption**: Opcjonalne, jeÅ›li chcesz szyfrowaÄ‡ dane.  
5. Kliknij **Create Volume**.  

---

### **2. PodÅ‚Ä…czanie woluminu do instancji EC2**  
1. WrÃ³Ä‡ do zakÅ‚adki **Volumes** w EC2.  
2. ZnajdÅº utworzony wolumin i zaznacz go.  
3. Kliknij **Actions** â†’ **Attach Volume**.  
4. Wybierz swojÄ… instancjÄ™ EC2.  
5. ZmieÅ„ urzÄ…dzenie na `/dev/xvdf` lub pozostaw domyÅ›lne `/dev/sdf`.  
6. Kliknij **Attach Volume**.  

---

### **3. Formatowanie i montowanie dysku w systemie operacyjnym EC2**  
1. PoÅ‚Ä…cz siÄ™ z instancjÄ… EC2 przez SSH:  
   ```sh
   ssh -i MyKey.pem ec2-user@<public-ip>
   ```
2. SprawdÅº, czy wolumin jest widoczny w systemie:  
   ```sh
   lsblk
   ```
   Oczekiwany wynik (nowy dysk `/dev/xvdf` lub `/dev/nvme1n1` dla instancji w Nitro):  
   ```
   NAME    MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
   xvda    202:0    0   10G  0 disk /
   xvdf    202:1    0   10G  0 disk 
   ```

3. JeÅ›li wolumin jest nowy, sformatuj go (np. w systemie plikÃ³w XFS):  
   ```sh
   sudo mkfs -t xfs /dev/xvdf
   ```
4. UtwÃ³rz punkt montowania:  
   ```sh
   sudo mkdir /mnt/my-ebs-volume
   ```
5. Zamontuj wolumin:  
   ```sh
   sudo mount /dev/xvdf /mnt/my-ebs-volume
   ```
6. SprawdÅº, czy wolumin jest zamontowany:  
   ```sh
   df -h
   ```
   Oczekiwany wynik:  
   ```
   Filesystem      Size  Used Avail Use% Mounted on
   /dev/xvdf       10G   0G   10G  0%   /mnt/my-ebs-volume
   ```

---

### **4. Automatyczne montowanie woluminu po restarcie**  
1. Pobierz identyfikator UUID nowego woluminu:  
   ```sh
   sudo blkid /dev/xvdf
   ```
   PrzykÅ‚adowy wynik:  
   ```
   /dev/xvdf: UUID="1234abcd-5678-efgh-ijkl-98765mnopqrs" TYPE="xfs"
   ```
2. Edytuj plik `/etc/fstab`:  
   ```sh
   sudo nano /etc/fstab
   ```
3. Dodaj nowÄ… liniÄ™, aby automatycznie montowaÄ‡ dysk po restarcie:  
   ```
   UUID=1234abcd-5678-efgh-ijkl-98765mnopqrs /mnt/my-ebs-volume xfs defaults,nofail 0 2
   ```
4. Zapisz zmiany i zamknij plik (`CTRL + X`, potem `Y`, nastÄ™pnie `Enter`).  
5. SprawdÅº poprawnoÅ›Ä‡ wpisÃ³w w `/etc/fstab`:  
   ```sh
   sudo mount -a
   ```
6. Uruchom ponownie instancjÄ™ i sprawdÅº, czy wolumin jest zamontowany po restarcie:  
   ```sh
   df -h
   ```
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

### **1. Tworzenie woluminu EBS**  
```sh
aws ec2 create-volume --size 10 --region us-east-1 --availability-zone us-east-1a --volume-type gp3
```

### **2. PodÅ‚Ä…czanie woluminu do instancji**  
```sh
aws ec2 attach-volume --volume-id vol-12345678 --instance-id i-12345678 --device /dev/xvdf
```

### **3. Formatowanie i montowanie w systemie operacyjnym EC2**  
```sh
sudo mkfs -t xfs /dev/xvdf
sudo mkdir /mnt/my-ebs-volume
sudo mount /dev/xvdf /mnt/my-ebs-volume
df -h
```

### **4. Automatyczne montowanie po restarcie**  
```sh
sudo blkid /dev/xvdf
sudo nano /etc/fstab
```
Dodaj liniÄ™:  
```
UUID=<UUID_Z_KOMENDY_BLKID> /mnt/my-ebs-volume xfs defaults,nofail 0 2
```
Zapisz (`CTRL + X`, `Y`, `Enter`) i sprawdÅº:  
```sh
sudo mount -a
df -h
```
</details>

---

# **Amazon S3**  
**Tworzenie i konfiguracja bucketu S3**  
- UtwÃ³rz **nowy bucket** S3 o unikalnej nazwie.  
- PrzeÅ›lij do niego plik `.txt`.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

### **1. Tworzenie bucketu S3**  
1. PrzejdÅº do **AWS Management Console** â†’ **S3**.  
2. Kliknij **Create bucket**.  
3. WypeÅ‚nij pola:  
   - **Bucket name**: `my-s3-bucket-<unikalna-nazwa>`  
   - **AWS Region**: Wybierz region bliski Twojej lokalizacji.  
   - **Block all public access**: **Zaznaczone** (domyÅ›lne).  
   - **Versioning**: MoÅ¼esz wÅ‚Ä…czyÄ‡ dla przechowywania wersji plikÃ³w.  
4. Kliknij **Create bucket**.  

---

### **2. PrzesyÅ‚anie pliku do S3**  
1. OtwÃ³rz swÃ³j bucket.  
2. Kliknij **Upload** â†’ **Add files**.  
3. Wybierz plik np. `myfile.txt`.  
4. Kliknij **Upload**.  
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

### **1. Tworzenie bucketu S3**
```sh
aws s3 mb s3://my-s3-bucket-<unikalna-nazwa>
```

### **2. PrzesyÅ‚anie pliku do S3**
```sh
aws s3 cp myfile.txt s3://my-s3-bucket-<unikalna-nazwa>/
```
</details>

**Hosting statycznej strony internetowej w S3**  
- WÅ‚Ä…cz opcjÄ™ **Static Website Hosting** w swoim buckecie.  
- PrzeÅ›lij plik `index.html` i ustaw odpowiednie uprawnienia.  
- SprawdÅº, czy strona dziaÅ‚a, wpisujÄ…c **URL bucketu** w przeglÄ…darce.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

### **1. Tworzenie bucketu S3**  
1. PrzejdÅº do **AWS Management Console** â†’ **S3**.  
2. Kliknij **Create bucket**.  
3. WypeÅ‚nij pola:  
   - **Bucket name**: `my-static-website-bucket-<unikalna-nazwa>`  
   - **AWS Region**: Wybierz najbliÅ¼szy region.  
   - **Block all public access**: **Odznacz** (aby strona byÅ‚a publiczna).  
   - **Bucket Versioning**: MoÅ¼esz wÅ‚Ä…czyÄ‡ dla przechowywania wersji plikÃ³w.  
4. Kliknij **Create bucket**.  

---

### **2. WÅ‚Ä…czenie hostingu statycznej strony**  
1. OtwÃ³rz swÃ³j bucket â†’ **Properties**.  
2. PrzejdÅº do **Static website hosting** â†’ **Edit**.  
3. Wybierz **Enable** i ustaw:  
   - **Index document**: `index.html`.  
   - **Error document**: `error.html` (opcjonalnie).  
4. Kliknij **Save changes**.  

---

### **3. PrzesyÅ‚anie plikÃ³w do S3**  
1. Przygotuj plik `index.html`:  
   ```html
   <html>
   <head><title>Moja Strona S3</title></head>
   <body>
       <h1>Witaj na mojej stronie hostowanej w Amazon S3!</h1>
   </body>
   </html>
   ```
2. W **S3 Console**, przejdÅº do bucketu â†’ **Upload** â†’ **Add files**.  
3. Wybierz `index.html` i kliknij **Upload**.  

---

### **4. Ustawienie uprawnieÅ„ publicznych**  
1. OtwÃ³rz bucket â†’ **Permissions** â†’ **Bucket Policy** â†’ **Edit**.  
2. Wklej poniÅ¼szÄ… politykÄ™ (zastÄ…p `my-static-website-bucket-<unikalna-nazwa>` nazwÄ… swojego bucketu):  
   ```json
   {
     "Version": "2012-10-17",
     "Statement": [
       {
         "Sid": "PublicReadGetObject",
         "Effect": "Allow",
         "Principal": "*",
         "Action": "s3:GetObject",
         "Resource": "arn:aws:s3:::my-static-website-bucket-<unikalna-nazwa>/*"
       }
     ]
   }
   ```
3. Kliknij **Save changes**.  

---

### **5. Otwieranie strony w przeglÄ…darce**  
1. WrÃ³Ä‡ do **Properties** â†’ **Static website hosting**.  
2. Skopiuj **Endpoint URL** i otwÃ³rz go w przeglÄ…darce.  
3. JeÅ›li widzisz stronÄ™ **"Witaj na mojej stronie hostowanej w Amazon S3!"**, konfiguracja jest poprawna! ðŸŽ‰  
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

### **1. Tworzenie bucketu**  
```sh
aws s3 mb s3://my-static-website-bucket-<unikalna-nazwa> --region us-east-1
```

### **2. WÅ‚Ä…czenie hostingu statycznej strony**  
```sh
aws s3 website s3://my-static-website-bucket-<unikalna-nazwa>/ --index-document index.html
```

### **3. PrzesyÅ‚anie plikÃ³w**  
```sh
aws s3 cp index.html s3://my-static-website-bucket-<unikalna-nazwa>/ --acl public-read
```

### **4. Ustawienie uprawnieÅ„ publicznych**  
```sh
aws s3api put-bucket-policy --bucket my-static-website-bucket-<unikalna-nazwa> --policy '{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::my-static-website-bucket-<unikalna-nazwa>/*"
    }
  ]
}'
```

### **5. Pobranie adresu strony**  
```sh
aws s3api get-bucket-website --bucket my-static-website-bucket-<unikalna-nazwa>
```
ðŸ“Œ Otrzymasz URL strony w odpowiedzi, np. `http://my-static-website-bucket-<unikalna-nazwa>.s3-website-us-east-1.amazonaws.com/`.  
</details>

**Tworzenie wersji plikÃ³w w S3 (Versioning)**  
- WÅ‚Ä…cz **Versioning** dla bucketu S3.  
- PrzeÅ›lij kilka wersji tego samego pliku.  
- PrzywrÃ³Ä‡ starszÄ… wersjÄ™ pliku.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

### **1. Tworzenie bucketu S3 (jeÅ›li nie istnieje)**  
1. PrzejdÅº do **AWS Management Console** â†’ **S3**.  
2. Kliknij **Create bucket**.  
3. WypeÅ‚nij pola:  
   - **Bucket name**: `my-versioned-bucket-<unikalna-nazwa>`  
   - **AWS Region**: Wybierz najbliÅ¼szy region.  
   - **Block all public access**: **Zaznaczone** (zalecane).  
4. Kliknij **Create bucket**.  

---

### **2. WÅ‚Ä…czenie wersjonowania**  
1. PrzejdÅº do **S3 Dashboard** â†’ OtwÃ³rz swÃ³j bucket.  
2. PrzejdÅº do zakÅ‚adki **Properties**.  
3. ZnajdÅº sekcjÄ™ **Bucket Versioning** â†’ Kliknij **Edit**.  
4. Wybierz **Enable** â†’ Kliknij **Save changes**.  

ðŸ“Œ **Teraz kaÅ¼da zmiana plikÃ³w w tym buckecie bÄ™dzie automatycznie zapisywana jako nowa wersja.**  

---

### **3. PrzesyÅ‚anie i edycja wersji plikÃ³w**  
1. PrzejdÅº do **Objects** w buckecie.  
2. Kliknij **Upload** â†’ **Add files** i wybierz `document.txt`.  
3. Kliknij **Upload**.  
4. **ZmieÅ„ plik**:  
   - Edytuj `document.txt` na swoim komputerze.  
   - Ponownie przeÅ›lij ten plik do S3, uÅ¼ywajÄ…c tej samej nazwy (`document.txt`).  
   - AWS automatycznie zapisze nowÄ… wersjÄ™.  

---

### **4. WyÅ›wietlanie i przywracanie wczeÅ›niejszych wersji plikÃ³w**  
1. W buckecie kliknij **Objects** â†’ ZnajdÅº `document.txt`.  
2. Kliknij **Versions** (obok nazwy pliku).  
3. Znajdziesz listÄ™ wersji pliku. Kliknij na starszÄ… wersjÄ™, aby jÄ… pobraÄ‡.  
4. Aby przywrÃ³ciÄ‡ starszÄ… wersjÄ™:  
   - Wybierz jÄ… i kliknij **Download**.  
   - Ponownie przeÅ›lij jÄ… jako najnowszÄ… wersjÄ™, aby nadpisaÄ‡ bieÅ¼Ä…cy plik.  

---

### **5. Usuwanie wersji plikÃ³w**  
- JeÅ›li usuniesz `document.txt`, plik pozostanie, ale jako **marker usuniÄ™cia**.  
- Aby **caÅ‚kowicie usunÄ…Ä‡ plik**, przejdÅº do **Versions**, wybierz wszystkie wersje i usuÅ„ je rÄ™cznie.  
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

### **1. Tworzenie bucketu S3 z wersjonowaniem**  
```sh
aws s3 mb s3://my-versioned-bucket-<unikalna-nazwa>
aws s3api put-bucket-versioning --bucket my-versioned-bucket-<unikalna-nazwa> --versioning-configuration Status=Enabled
```

### **2. PrzesyÅ‚anie pliku do S3**
```sh
echo "To jest pierwsza wersja" > document.txt
aws s3 cp document.txt s3://my-versioned-bucket-<unikalna-nazwa>/
```

### **3. Nadpisanie pliku i utworzenie nowej wersji**
```sh
echo "To jest druga wersja" > document.txt
aws s3 cp document.txt s3://my-versioned-bucket-<unikalna-nazwa>/
```

### **4. WyÅ›wietlanie wersji pliku**
```sh
aws s3api list-object-versions --bucket my-versioned-bucket-<unikalna-nazwa>
```

PrzykÅ‚adowy wynik:
```json
{
    "Versions": [
        {
            "Key": "document.txt",
            "VersionId": "3z4fE...",
            "IsLatest": true,
            "LastModified": "2024-02-12T12:00:00.000Z"
        },
        {
            "Key": "document.txt",
            "VersionId": "8a2fG...",
            "IsLatest": false,
            "LastModified": "2024-02-12T11:50:00.000Z"
        }
    ]
}
```

### **5. Pobieranie konkretnej wersji pliku**
```sh
aws s3api get-object --bucket my-versioned-bucket-<unikalna-nazwa> --key document.txt --version-id 8a2fG... old-document.txt
```

### **6. Usuwanie wersji plikÃ³w**  
1. Oznaczenie pliku jako usuniÄ™tego (dodanie marker delete):  
   ```sh
   aws s3 rm s3://my-versioned-bucket-<unikalna-nazwa>/document.txt
   ```
2. CaÅ‚kowite usuniÄ™cie konkretnej wersji:  
   ```sh
   aws s3api delete-object --bucket my-versioned-bucket-<unikalna-nazwa> --key document.txt --version-id 3z4fE...
   ```
</details>

**Automatyczne przenoszenie danych do taÅ„szej klasy storage**  
- Skonfiguruj **Lifecycle Policy**, aby pliki starsze niÅ¼ 30 dni byÅ‚y przenoszone do **S3 Glacier**. 

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

### **1. Tworzenie bucketu S3 (jeÅ›li nie istnieje)**  
1. PrzejdÅº do **AWS Management Console** â†’ **S3**.  
2. Kliknij **Create bucket**.  
3. WypeÅ‚nij pola:  
   - **Bucket name**: `my-lifecycle-bucket-<unikalna-nazwa>`  
   - **AWS Region**: Wybierz region bliski Twojej lokalizacji.  
   - **Block all public access**: **Zaznaczone** (zalecane).  
4. Kliknij **Create bucket**.  

---

### **2. Tworzenie Lifecycle Policy**  
1. OtwÃ³rz swÃ³j **bucket S3**.  
2. PrzejdÅº do zakÅ‚adki **Management** â†’ **Lifecycle rules**.  
3. Kliknij **Create lifecycle rule**.  
4. **Podaj nazwÄ™ reguÅ‚y**, np. `MoveToGlacierAfter30Days`.  
5. W sekcji **Choose rule scope** wybierz:  
   - **Apply to all objects in the bucket** (jeÅ›li chcesz zastosowaÄ‡ reguÅ‚Ä™ do caÅ‚ego bucketu)  
   - Lub okreÅ›l prefiks dla konkretnego katalogu, np. `logs/`  
6. Wybierz **Lifecycle rule actions**:  
   - **Move current versions of objects to Glacier**  
   - Wybierz **Glacier Flexible Retrieval** lub **Glacier Instant Retrieval**  
   - Ustaw **30 days**  
7. Kliknij **Create rule**.  

ðŸ“Œ **Teraz kaÅ¼dy plik w buckecie bÄ™dzie przenoszony do Glacier po 30 dniach.**  
</details>
<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

### **1. Tworzenie bucketu (jeÅ›li nie istnieje)**  
```sh
aws s3 mb s3://my-lifecycle-bucket-<unikalna-nazwa>
```

### **2. Tworzenie pliku polityki Lifecycle**
UtwÃ³rz plik `lifecycle.json`:
```json
{
    "Rules": [
        {
            "ID": "MoveToGlacierAfter30Days",
            "Filter": {
                "Prefix": ""
            },
            "Status": "Enabled",
            "Transitions": [
                {
                    "Days": 30,
                    "StorageClass": "GLACIER"
                }
            ]
        }
    ]
}
```

### **3. Przypisanie polityki do bucketu**
```sh
aws s3api put-bucket-lifecycle-configuration --bucket my-lifecycle-bucket-<unikalna-nazwa> --lifecycle-configuration file://lifecycle.json
```

### **4. Sprawdzenie ustawieÅ„ Lifecycle Policy**
```sh
aws s3api get-bucket-lifecycle-configuration --bucket my-lifecycle-bucket-<unikalna-nazwa>
```

---

## **ðŸ“Œ Testowanie polityki Lifecycle**  
1. **PrzeÅ›lij plik do S3**  
   ```sh
   echo "Testowy plik do archiwizacji" > testfile.txt
   aws s3 cp testfile.txt s3://my-lifecycle-bucket-<unikalna-nazwa>/
   ```
2. **Poczekaj 30 dni lub zmodyfikuj politykÄ™ na 1 dzieÅ„** (do testÃ³w).  
3. **SprawdÅº klasÄ™ przechowywania pliku**  
   ```sh
   aws s3api head-object --bucket my-lifecycle-bucket-<unikalna-nazwa> --key testfile.txt
   ```
   JeÅ›li plik zostaÅ‚ przeniesiony, zobaczysz `StorageClass: GLACIER`.  
</details>