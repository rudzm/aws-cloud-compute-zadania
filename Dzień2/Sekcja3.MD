## **Zadania praktyczne dla sekcji 3: Deploy and Monitoring** 

## **1. Tworzenie niestandardowych metryk CloudWatch**  
- Skonfiguruj metrykÄ™ **CPUUtilization** dla instancji EC2.  
- Skonfiguruj reguÅ‚Ä™ **Alarm**, ktÃ³ra wysyÅ‚a powiadomienie e-mail/SNS, gdy zuÅ¼ycie CPU przekroczy 80%. 

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Tworzenie metryki CloudWatch dla EC2**  
1. PrzejdÅº do **AWS Management Console** â†’ **CloudWatch**.  
2. Kliknij **Metrics** â†’ **Browse metrics**.  
3. Wybierz **EC2** â†’ **Per-Instance Metrics**.  
4. ZnajdÅº instancjÄ™ EC2, ktÃ³rÄ… chcesz monitorowaÄ‡, i zaznacz `CPUUtilization`.  
5. Kliknij **Actions** â†’ **Create Alarm**.  

---

**2. Tworzenie alarmu CloudWatch dla metryki CPU**  
1. **Define Alarm**:  
   - W sekcji **Threshold type** wybierz **Static**.  
   - Wybierz **Greater than threshold** i ustaw wartoÅ›Ä‡ **80** (80% CPU).  
2. **Configure Actions**:  
   - Wybierz **Create new SNS topic** i wpisz nazwÄ™ np. `CPU-High-Alert`.  
   - Dodaj swÃ³j adres e-mail do powiadomieÅ„.  
   - Kliknij **Create topic** i **Confirm subscription** na swojej skrzynce e-mail.  
3. **Name and description**:  
   - Nazwa alarmu: `High CPU Usage Alarm`.  
   - Opis: `Powiadomienie o wysokim zuÅ¼yciu CPU na EC2`.  
4. Kliknij **Create alarm**.  

ğŸ“Œ **CloudWatch teraz monitoruje CPU i wyÅ›le powiadomienie, gdy CPU przekroczy 80%!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Tworzenie metryki CloudWatch dla instancji EC2**  
ğŸ“Œ Pobierz **Instance ID** swojej instancji EC2:  
```sh
aws ec2 describe-instances --query "Reservations[*].Instances[*].InstanceId" --output text
```
ZaÅ‚Ã³Å¼my, Å¼e wynik to `i-0123456789abcdef0`.

---

**2. WysÅ‚anie danych do CloudWatch**  
Dodanie metryki CPU do CloudWatch:  
```sh
aws cloudwatch put-metric-data \
    --namespace "CustomEC2Metrics" \
    --metric-name "CPUUtilization" \
    --dimensions InstanceId=i-0123456789abcdef0 \
    --value 25
```

ğŸ“Œ **To symuluje uÅ¼ycie CPU na poziomie 25%.**  

---

**3. Tworzenie alarmu dla wysokiego uÅ¼ycia CPU**  
```sh
aws cloudwatch put-metric-alarm \
    --alarm-name "HighCPUAlarm" \
    --metric-name "CPUUtilization" \
    --namespace "AWS/EC2" \
    --statistic "Average" \
    --dimensions Name=InstanceId,Value=i-0123456789abcdef0 \
    --threshold 80 \
    --comparison-operator GreaterThanThreshold \
    --evaluation-periods 2 \
    --period 60 \
    --alarm-actions arn:aws:sns:us-east-1:123456789012:CPU-High-Alert
```

ğŸ“Œ **Alarm aktywuje siÄ™, gdy CPU przekroczy 80% przez co najmniej 2 minuty!**  

---

**4. Sprawdzenie statusu alarmu**  
```sh
aws cloudwatch describe-alarms --alarm-names "HighCPUAlarm"
```
</details>

---

## **2. Logowanie i analiza logÃ³w aplikacji w CloudWatch Logs**  
- Skonfiguruj **CloudWatch Logs** dla aplikacji dziaÅ‚ajÄ…cej na instancji EC2.  
- Analizuj logi i znajdÅº bÅ‚Ä™dy aplikacji.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Tworzenie grupy logÃ³w w CloudWatch**  
1. PrzejdÅº do **AWS Management Console** â†’ **CloudWatch**.  
2. W lewym menu wybierz **Logs** â†’ **Log groups**.  
3. Kliknij **Create log group**.  
4. Wpisz nazwÄ™: `MyAppLogs`.  
5. Kliknij **Create**.  

---

**2. Instalacja i konfiguracja CloudWatch Agent na EC2**  
1. PrzejdÅº do **AWS Management Console** â†’ **EC2**.  
2. ZnajdÅº swojÄ… instancjÄ™ EC2, otwÃ³rz **Connect** â†’ **Session Manager** lub **SSH**.  
3. Zainstaluj **CloudWatch Agent** (dla Amazon Linux/Ubuntu):  

   ```sh
   sudo yum install -y amazon-cloudwatch-agent
   ```

4. Skonfiguruj **CloudWatch Agent**, aby monitorowaÅ‚ `/var/log` (np. logi aplikacji Nginx):  

   ```sh
   sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-config-wizard
   ```

5. Uruchom agent:  

   ```sh
   sudo systemctl start amazon-cloudwatch-agent
   ```

6. Zweryfikuj status agenta:  

   ```sh
   sudo systemctl status amazon-cloudwatch-agent
   ```

ğŸ“Œ **Teraz logi aplikacji sÄ… przesyÅ‚ane do CloudWatch Logs!** ğŸ‰  

---

**3. Analiza logÃ³w w AWS CloudWatch Logs**  
1. PrzejdÅº do **CloudWatch Logs** â†’ **Log groups** â†’ `MyAppLogs`.  
2. Kliknij w **Latest Log Stream** i przeglÄ…daj logi.  
3. Aby wyszukaÄ‡ bÅ‚Ä™dy, uÅ¼yj filtra:  
   ```
   ? ERROR
   ```
4. MoÅ¼esz ustawiÄ‡ **CloudWatch Alarm**, aby powiadomiÅ‚ o bÅ‚Ä™dach w logach.  

ğŸ“Œ **Teraz AWS CloudWatch zbiera logi aplikacji i umoÅ¼liwia ich analizÄ™!**  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Tworzenie grupy logÃ³w**  
```sh
aws logs create-log-group --log-group-name MyAppLogs
```

---

**2. Tworzenie strumienia logÃ³w**  
```sh
aws logs create-log-stream --log-group-name MyAppLogs --log-stream-name MyAppInstance
```

---

**3. Instalacja CloudWatch Agent na EC2**  
PoÅ‚Ä…cz siÄ™ z instancjÄ… EC2:  
```sh
ssh -i my-key.pem ec2-user@<EC2_PUBLIC_IP>
```
Zainstaluj agent CloudWatch:  
```sh
sudo yum install -y amazon-cloudwatch-agent
```

Skonfiguruj monitorowanie logÃ³w `/var/log/messages`:  
```sh
sudo tee /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json <<EOF
{
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/messages",
            "log_group_name": "MyAppLogs",
            "log_stream_name": "{instance_id}"
          }
        ]
      }
    }
  }
}
EOF
```

Uruchom agent:  
```sh
sudo systemctl start amazon-cloudwatch-agent
```

ğŸ“Œ **CloudWatch Agent teraz przesyÅ‚a logi do AWS CloudWatch!** ğŸ‰  

---

**4. Analiza logÃ³w w CloudWatch**  
Pobranie 10 najnowszych wpisÃ³w logÃ³w:  
```sh
aws logs get-log-events --log-group-name MyAppLogs --log-stream-name MyAppInstance --limit 10
```

Wyszukiwanie bÅ‚Ä™dÃ³w w logach:  
```sh
aws logs filter-log-events --log-group-name MyAppLogs --filter-pattern "ERROR"
```

ğŸ“Œ **Teraz moÅ¼esz analizowaÄ‡ logi aplikacji z poziomu CLI!** ğŸ‰  

</details>

---

## **3. Tworzenie dashboardÃ³w CloudWatch**  
- UtwÃ³rz dashboard CloudWatch do monitorowania **CPU**, **dyskÃ³w** i **sieci** dla instancji EC2.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Tworzenie nowego dashboardu**  
1. PrzejdÅº do **AWS Management Console** â†’ **CloudWatch**.  
2. Wybierz **Dashboards** â†’ **Create dashboard**.  
3. Wpisz nazwÄ™ dashboardu: `EC2-Monitoring-Dashboard`.  
4. Kliknij **Create dashboard**.  

---

**2. Dodanie metryk do dashboardu**  

#**Dodanie metryki CPU**
1. Kliknij **Add widget**.  
2. Wybierz **Line graph** â†’ **Next**.  
3. Wybierz **Metrics** â†’ **EC2** â†’ **Per-Instance Metrics**.  
4. Zaznacz `CPUUtilization` dla swojej instancji.  
5. Kliknij **Create widget**.  

#**Dodanie metryki uÅ¼ycia dysku**
1. Kliknij **Add widget** â†’ **Line graph**.  
2. Wybierz **Metrics** â†’ **EC2** â†’ **Per-Instance Metrics**.  
3. Wybierz metrykÄ™ `DiskReadOps` oraz `DiskWriteOps`.  
4. Kliknij **Create widget**.  

#**Dodanie metryki ruchu sieciowego**
1. Kliknij **Add widget** â†’ **Line graph**.  
2. Wybierz **Metrics** â†’ **EC2** â†’ **Per-Instance Metrics**.  
3. Wybierz `NetworkIn` oraz `NetworkOut`.  
4. Kliknij **Create widget**.  

ğŸ“Œ **Dashboard CloudWatch teraz monitoruje CPU, dyski i sieÄ‡ dla EC2!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Tworzenie dashboardu**  
```sh
aws cloudwatch put-dashboard --dashboard-name EC2-Monitoring-Dashboard --dashboard-body '{
    "widgets": []
}'
```

---

**2. Dodanie metryk do dashboardu**  

#**Dodanie wykresu CPU**  
```sh
aws cloudwatch put-dashboard --dashboard-name EC2-Monitoring-Dashboard --dashboard-body '{
    "widgets": [
        {
            "type": "metric",
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 6,
            "properties": {
                "metrics": [
                    [ "AWS/EC2", "CPUUtilization", "InstanceId", "i-0123456789abcdef0" ]
                ],
                "title": "CPU Usage",
                "view": "timeSeries",
                "stacked": false,
                "region": "us-east-1"
            }
        }
    ]
}'
```

---

#**Dodanie wykresu ruchu sieciowego**  
```sh
aws cloudwatch put-dashboard --dashboard-name EC2-Monitoring-Dashboard --dashboard-body '{
    "widgets": [
        {
            "type": "metric",
            "x": 6,
            "y": 0,
            "width": 6,
            "height": 6,
            "properties": {
                "metrics": [
                    [ "AWS/EC2", "NetworkIn", "InstanceId", "i-0123456789abcdef0" ],
                    [ "AWS/EC2", "NetworkOut", "InstanceId", "i-0123456789abcdef0" ]
                ],
                "title": "Network Traffic",
                "view": "timeSeries",
                "stacked": false,
                "region": "us-east-1"
            }
        }
    ]
}'
```

---

**3. Sprawdzenie utworzonego dashboardu**  
```sh
aws cloudwatch get-dashboard --dashboard-name EC2-Monitoring-Dashboard
```

ğŸ“Œ **Dashboard CloudWatch teraz monitoruje kluczowe metryki dla EC2!** ğŸ‰  
</details>

---

## **4. Tworzenie grupy Auto Scaling dla instancji EC2**  
- Skonfiguruj grupÄ™ Auto Scaling z minimum **1** i maksimum **3** instancjami EC2.  
- Ustaw reguÅ‚Ä™ automatycznego zwiÄ™kszania instancji przy wysokim obciÄ…Å¼eniu CPU.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Tworzenie Launch Template (szablonu uruchamiania)**  
1. PrzejdÅº do **AWS Management Console** â†’ **EC2**.  
2. Wybierz **Launch Templates** â†’ **Create launch template**.  
3. Wpisz:  
   - **Launch template name**: `my-launch-template`.  
   - **Amazon Machine Image (AMI)**: Wybierz Amazon Linux 2.  
   - **Instance type**: `t2.micro`.  
   - **Key pair**: Wybierz istniejÄ…cy lub utwÃ³rz nowy.  
   - **Security group**: OtwÃ³rz port **80** i **22**.  
4. Kliknij **Create launch template**.  

---

**2. Tworzenie grupy Auto Scaling**  
1. PrzejdÅº do **EC2** â†’ **Auto Scaling Groups**.  
2. Kliknij **Create Auto Scaling group**.  
3. Wpisz **Auto Scaling group name**: `my-auto-scaling-group`.  
4. Wybierz wczeÅ›niej utworzony **Launch Template** â†’ `my-launch-template`.  
5. Wybierz **VPC** i subnety dla instancji.  
6. Kliknij **Next** i ustaw:  
   - **Minimum instances**: `1`  
   - **Maximum instances**: `3`  
   - **Desired capacity**: `1`  
7. Kliknij **Next** i **Create Auto Scaling Group**.  

ğŸ“Œ **Teraz Auto Scaling uruchomi i zarzÄ…dza instancjami EC2!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Tworzenie Launch Template**  
```sh
aws ec2 create-launch-template \
    --launch-template-name my-launch-template \
    --version-description "Initial version" \
    --launch-template-data '{
        "ImageId": "ami-0abcdef1234567890",
        "InstanceType": "t2.micro",
        "KeyName": "my-key-pair",
        "SecurityGroupIds": ["sg-0123456789abcdef0"]
    }'
```
ğŸ“Œ **PodmieÅ„ `ami-0abcdef1234567890` na aktualny AMI dla Amazon Linux 2.**  

---

**2. Tworzenie grupy Auto Scaling**  
```sh
aws autoscaling create-auto-scaling-group \
    --auto-scaling-group-name my-auto-scaling-group \
    --launch-template "LaunchTemplateName=my-launch-template,Version=1" \
    --min-size 1 --max-size 3 --desired-capacity 1 \
    --vpc-zone-identifier "subnet-0123456789abcdef0"
```
ğŸ“Œ **PodmieÅ„ `subnet-0123456789abcdef0` na poprawne ID subnetu w Twojej VPC.**  

---

**3. Sprawdzenie statusu grupy Auto Scaling**  
```sh
aws autoscaling describe-auto-scaling-groups --auto-scaling-group-name my-auto-scaling-group
```

ğŸ“Œ **Grupa Auto Scaling dziaÅ‚a i zarzÄ…dza instancjami EC2!** ğŸ‰  


</details>

---

## **5. Testowanie Auto Scaling**  
- WymuÅ› wysokie zuÅ¼ycie CPU na instancji i zweryfikuj, czy AWS dodaÅ‚ nowe instancje EC2.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Konfiguracja polityki skalowania w Auto Scaling**  
1. PrzejdÅº do **AWS Management Console** â†’ **EC2**.  
2. Wybierz **Auto Scaling Groups** â†’ ZnajdÅº `my-auto-scaling-group`.  
3. PrzejdÅº do zakÅ‚adki **Automatic scaling** â†’ **Create scaling policy**.  
4. Wybierz **Target tracking scaling policy**.  
5. W sekcji **Metric type** wybierz **Average CPU utilization**.  
6. Ustaw docelowe uÅ¼ycie CPU na **50%**.  
7. Kliknij **Create**.  

ğŸ“Œ **Teraz Auto Scaling bÄ™dzie dodawaÅ‚ instancje, gdy Å›rednie obciÄ…Å¼enie CPU przekroczy 50%.**  

---

**2. Wymuszenie wysokiego zuÅ¼ycia CPU na instancji EC2**  
1. PrzejdÅº do **EC2 Instances** i poÅ‚Ä…cz siÄ™ z instancjÄ… przez **Session Manager** lub **SSH**.  
2. JeÅ›li instancja korzysta z **Amazon Linux** lub **Ubuntu**, uruchom:  

   ```sh
   sudo yum install -y stress || sudo apt install -y stress
   ```
3. Uruchom sztuczne obciÄ…Å¼enie CPU:  

   ```sh
   stress --cpu 2 --timeout 300
   ```
   ğŸ“Œ ObciÄ…Å¼enie potrwa **5 minut** (300 sekund).  

4. PrzejdÅº do **CloudWatch Metrics** â†’ **EC2** â†’ **CPUUtilization** i sprawdÅº wzrost obciÄ…Å¼enia.  
5. Po kilku minutach Auto Scaling powinno automatycznie dodaÄ‡ nowÄ… instancjÄ™ EC2.  

ğŸ“Œ **Instancje EC2 automatycznie siÄ™ skalujÄ… w odpowiedzi na wysokie zuÅ¼ycie CPU!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Konfiguracja polityki skalowania**  
```sh
aws autoscaling put-scaling-policy \
    --auto-scaling-group-name my-auto-scaling-group \
    --policy-name "ScaleOnHighCPU" \
    --policy-type TargetTrackingScaling \
    --target-tracking-configuration '{
        "PredefinedMetricSpecification": {
            "PredefinedMetricType": "ASGAverageCPUUtilization"
        },
        "TargetValue": 50.0
    }'
```

ğŸ“Œ **Teraz Auto Scaling doda nowe instancje, gdy Å›rednie zuÅ¼ycie CPU przekroczy 50%.**  

---

**2. Wymuszenie wysokiego zuÅ¼ycia CPU na instancji EC2**  
ğŸ“Œ Pobierz ID pierwszej instancji w grupie Auto Scaling:  
```sh
aws autoscaling describe-auto-scaling-groups \
    --auto-scaling-group-name my-auto-scaling-group \
    --query "AutoScalingGroups[0].Instances[0].InstanceId" --output text
```

PoÅ‚Ä…cz siÄ™ z instancjÄ… EC2:  
```sh
ssh -i my-key.pem ec2-user@<EC2_PUBLIC_IP>
```

Zainstaluj i uruchom test obciÄ…Å¼enia CPU:  
```sh
sudo yum install -y stress || sudo apt install -y stress
stress --cpu 2 --timeout 300
```

ğŸ“Œ **Monitoruj metryki CPU w CloudWatch i sprawdÅº, czy Auto Scaling dodaje nowe instancje!** ğŸ‰  

---

**3. Sprawdzenie dodanych instancji EC2 przez Auto Scaling**  
```sh
aws ec2 describe-instances --filters "Name=tag:aws:autoscaling:groupName,Values=my-auto-scaling-group"
```

ğŸ“Œ **JeÅ›li widzisz wiÄ™cej niÅ¼ jednÄ… instancjÄ™, oznacza to, Å¼e Auto Scaling dziaÅ‚a poprawnie!** ğŸ‰  
</details>

---

## **6. Skonfigurowanie polityki zmniejszania liczby instancji**  
- Skonfiguruj Auto Scaling tak, aby zmniejszaÅ‚ liczbÄ™ instancji, gdy CPU spadnie poniÅ¼ej 30%.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Edycja polityki Auto Scaling**  
1. PrzejdÅº do **AWS Management Console** â†’ **EC2**.  
2. Wybierz **Auto Scaling Groups** â†’ ZnajdÅº `my-auto-scaling-group`.  
3. PrzejdÅº do zakÅ‚adki **Automatic scaling** â†’ **Edit**.  
4. Kliknij **Create scaling policy**.  
5. Wybierz **Target tracking scaling policy**.  
6. **Metric type**: Wybierz **Average CPU utilization**.  
7. **Target value**: Ustaw **30%**.  
8. **Scale-in protection**: WyÅ‚Ä…cz ochronÄ™ przed usuniÄ™ciem instancji.  
9. Kliknij **Create policy**.  

ğŸ“Œ **Teraz Auto Scaling bÄ™dzie usuwaÄ‡ instancje EC2, gdy CPU spadnie poniÅ¼ej 30%!** ğŸ‰  

---

**2. Testowanie skalowania w dÃ³Å‚**  
1. PoÅ‚Ä…cz siÄ™ z instancjÄ… EC2 i **zakoÅ„cz procesy zuÅ¼ywajÄ…ce CPU**:  
   ```sh
   sudo pkill -f stress
   ```
2. PrzejdÅº do **CloudWatch Metrics** â†’ **EC2** â†’ **CPUUtilization**.  
3. Gdy CPU spadnie poniÅ¼ej 30%, Auto Scaling **powinien automatycznie usunÄ…Ä‡ nadmiarowe instancje**.  

ğŸ“Œ **AWS teraz redukuje liczbÄ™ instancji w czasie niskiego obciÄ…Å¼enia!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Konfiguracja polityki zmniejszania liczby instancji**  
```sh
aws autoscaling put-scaling-policy \
    --auto-scaling-group-name my-auto-scaling-group \
    --policy-name "ScaleDownOnLowCPU" \
    --policy-type TargetTrackingScaling \
    --target-tracking-configuration '{
        "PredefinedMetricSpecification": {
            "PredefinedMetricType": "ASGAverageCPUUtilization"
        },
        "TargetValue": 30.0
    }'
```

ğŸ“Œ **Teraz Auto Scaling usunie instancje, gdy Å›rednie obciÄ…Å¼enie CPU spadnie poniÅ¼ej 30%!**  

---

**2. Weryfikacja dziaÅ‚ania polityki Auto Scaling**  
ğŸ“Œ Pobierz informacje o grupie Auto Scaling:  
```sh
aws autoscaling describe-auto-scaling-groups --auto-scaling-group-name my-auto-scaling-group
```

ğŸ“Œ Pobierz szczegÃ³Å‚y polityki skalowania:  
```sh
aws autoscaling describe-policies --auto-scaling-group-name my-auto-scaling-group
```

ğŸ“Œ SprawdÅº aktualnÄ… liczbÄ™ instancji EC2 w Auto Scaling:  
```sh
aws ec2 describe-instances --filters "Name=tag:aws:autoscaling:groupName,Values=my-auto-scaling-group"
```

ğŸ“Œ **JeÅ›li liczba instancji zmniejszy siÄ™ po spadku CPU poniÅ¼ej 30%, oznacza to, Å¼e polityka dziaÅ‚a poprawnie!** ğŸ‰  

</details>

---

## **7. Sprawdzenie rekomendacji Trusted Advisor**  
- PrzejdÅº do **AWS Trusted Advisor** i przeanalizuj dostÄ™pne rekomendacje.  
- Zidentyfikuj potencjalne oszczÄ™dnoÅ›ci kosztÃ³w i poprawki zwiÄ…zane z bezpieczeÅ„stwem.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. PrzeglÄ…d rekomendacji w AWS Trusted Advisor**  
1. PrzejdÅº do **AWS Management Console** â†’ **Trusted Advisor**.  
2. Na stronie gÅ‚Ã³wnej zobaczysz **5 gÅ‚Ã³wnych kategorii rekomendacji**:  
   - **Cost Optimization** (OszczÄ™dnoÅ›Ä‡ kosztÃ³w)  
   - **Performance** (WydajnoÅ›Ä‡)  
   - **Security** (BezpieczeÅ„stwo)  
   - **Fault Tolerance** (OdpornoÅ›Ä‡ na bÅ‚Ä™dy)  
   - **Service Limits** (Limity usÅ‚ug)  
3. Kliknij w kaÅ¼dÄ… kategoriÄ™, aby zobaczyÄ‡ rekomendacje.  

---

**2. Analiza rekomendacji i podejmowanie dziaÅ‚aÅ„**  

#**Cost Optimization (OszczÄ™dnoÅ›Ä‡ kosztÃ³w)**  
- SprawdÅº, czy masz **niewykorzystane instancje EC2** lub **nieuÅ¼ywane woluminy EBS**.  
- Zweryfikuj, czy moÅ¼na uÅ¼yÄ‡ instancji Reserved Instances lub Savings Plans.  

#**Security (BezpieczeÅ„stwo)**  
- SprawdÅº, czy masz **publiczne grupy Security Groups** z otwartymi portami.  
- Zweryfikuj, czy **wielu uÅ¼ytkownikÃ³w IAM nie posiada nadmiernych uprawnieÅ„**.  

#**Performance (WydajnoÅ›Ä‡)**  
- SprawdÅº, czy masz **przeciÄ…Å¼one instancje EC2** i czy moÅ¼na dodaÄ‡ Auto Scaling.  
- Zweryfikuj, czy RDS nie wymaga optymalizacji bazy danych.  

ğŸ“Œ **Zapisz rekomendacje i podejmij dziaÅ‚ania optymalizacyjne!** ğŸ‰  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Pobranie rekomendacji Trusted Advisor**  
Uruchom nastÄ™pujÄ…ce polecenie, aby pobraÄ‡ **wszystkie rekomendacje Trusted Advisor**:  
```sh
aws support describe-trusted-advisor-checks --language en
```
ğŸ“Œ **ZwrÃ³ci listÄ™ dostÄ™pnych kontroli.**  

---

**2. Pobranie szczegÃ³Å‚owych wynikÃ³w dla poszczegÃ³lnych kategorii**  

#**Sprawdzenie optymalizacji kosztÃ³w**  
```sh
aws support describe-trusted-advisor-check-result \
    --check-id e7f47a28-07c5-49db-a204-2f0a79c806c0 \
    --language en
```
ğŸ“Œ **Sprawdza niewykorzystane instancje EC2, woluminy EBS i S3.**  

#**Sprawdzenie bezpieczeÅ„stwa**  
```sh
aws support describe-trusted-advisor-check-result \
    --check-id 39f3e42a-2f37-4d3d-89de-7603f5b72412 \
    --language en
```
ğŸ“Œ **Sprawdza grupy Security Groups, uprawnienia IAM i dostÄ™p publiczny.**  

#**Sprawdzenie wydajnoÅ›ci**  
```sh
aws support describe-trusted-advisor-check-result \
    --check-id 9f38d7a2-9a0a-42c5-adaf-9cbb451f7c55 \
    --language en
```
ğŸ“Œ **Sprawdza przeciÄ…Å¼one EC2, RDS i optymalizacjÄ™ sieci.**  

---

**3. Weryfikacja wynikÃ³w i podjÄ™cie dziaÅ‚aÅ„**  
ğŸ“Œ **Wyniki Trusted Advisor sÄ… zwracane w formacie JSON â€“ sprawdÅº, ktÃ³re zasoby wymagajÄ… uwagi i podejmij dziaÅ‚ania optymalizacyjne.**  

</details>

---

## **8. Optymalizacja bezpieczeÅ„stwa za pomocÄ… Trusted Advisor**  
- ZnajdÅº nieuÅ¼ywane uprawnienia IAM i zidentyfikuj potencjalne zagroÅ¼enia.  
- WprowadÅº poprawki na podstawie rekomendacji Trusted Advisor.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. Sprawdzenie rekomendacji Trusted Advisor dla bezpieczeÅ„stwa**  
1. PrzejdÅº do **AWS Management Console** â†’ **Trusted Advisor**.  
2. Wybierz kategoriÄ™ **Security**.  
3. Przejrzyj kluczowe kontrole bezpieczeÅ„stwa, takie jak:  
   - **Security Groups - Unrestricted Access** (publiczne porty)  
   - **IAM Use** (nadmierne uprawnienia IAM)  
   - **S3 Bucket Permissions** (publiczny dostÄ™p do danych)  
   - **MFA on Root Account** (brak MFA na koncie root)  

---

**2. Optymalizacja Security Groups**  
1. Kliknij w rekomendacjÄ™ **Security Groups - Unrestricted Access**.  
2. SprawdÅº grupy zabezpieczeÅ„, ktÃ³re majÄ… otwarte porty (np. `0.0.0.0/0`).  
3. OtwÃ³rz **AWS EC2** â†’ **Security Groups**.  
4. Edytuj problematyczne grupy zabezpieczeÅ„ i ogranicz dostÄ™p do okreÅ›lonych adresÃ³w IP.  

ğŸ“Œ **Teraz tylko uprawnione adresy IP majÄ… dostÄ™p do zasobÃ³w AWS!** ğŸ‰  

---

**3. Ograniczenie nadmiernych uprawnieÅ„ IAM**  
1. Kliknij w rekomendacjÄ™ **IAM Use**.  
2. SprawdÅº listÄ™ uÅ¼ytkownikÃ³w IAM z uprawnieniami **AdministratorAccess**.  
3. OtwÃ³rz **AWS IAM** â†’ **Users**.  
4. UsuÅ„ nadmiarowe uprawnienia i zastosuj zasadÄ™ **Least Privilege Access**.  

ğŸ“Œ **Tylko wymagane uprawnienia sÄ… teraz przypisane do uÅ¼ytkownikÃ³w IAM!**  

---

**4. Sprawdzenie publicznych bucketÃ³w S3**  
1. Kliknij w rekomendacjÄ™ **S3 Bucket Permissions**.  
2. SprawdÅº, czy sÄ… jakieÅ› publicznie dostÄ™pne buckety S3.  
3. OtwÃ³rz **AWS S3** â†’ **Permissions** dla kaÅ¼dego bucketa.  
4. JeÅ›li bucket nie powinien byÄ‡ publiczny, usuÅ„ dostÄ™p **Public Access**.  

ğŸ“Œ **Dane S3 sÄ… teraz chronione przed nieautoryzowanym dostÄ™pem!**
</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**1. Pobranie rekomendacji Trusted Advisor dotyczÄ…cych bezpieczeÅ„stwa**  
ğŸ“Œ Pobierz **listÄ™ wszystkich kontroli Trusted Advisor**:  
```sh
aws support describe-trusted-advisor-checks --language en
```
ğŸ“Œ **SprawdÅº ID dla kategorii bezpieczeÅ„stwa.**  

---

**2. Sprawdzenie otwartych Security Groups**  
```sh
aws support describe-trusted-advisor-check-result \
    --check-id e52a62f0-5f4d-4e26-92dc-576f5f7b8d5b \
    --language en
```
ğŸ“Œ **ZwrÃ³ci listÄ™ Security Groups z otwartymi portami (`0.0.0.0/0`).**  

#**Ograniczenie dostÄ™pu w Security Group**  
```sh
aws ec2 revoke-security-group-ingress \
    --group-id sg-0123456789abcdef0 \
    --protocol tcp --port 22 --cidr 0.0.0.0/0
```
ğŸ“Œ **Usuwa reguÅ‚Ä™, ktÃ³ra pozwala na publiczny dostÄ™p SSH.**  

---

**3. Sprawdzenie uÅ¼ytkownikÃ³w IAM z nadmiernymi uprawnieniami**  
```sh
aws iam list-users
```
ğŸ“Œ **SprawdÅº, czy uÅ¼ytkownicy IAM majÄ… przypisane peÅ‚ne uprawnienia (`AdministratorAccess`).**  

#**UsuniÄ™cie uprawnieÅ„ AdministratorAccess**  
```sh
aws iam detach-user-policy --user-name "TestUser" \
    --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
```
ğŸ“Œ **Teraz uÅ¼ytkownik `TestUser` nie ma nadmiernych uprawnieÅ„.**  

---

**4. Sprawdzenie publicznych bucketÃ³w S3**  
```sh
aws s3api list-buckets --query "Buckets[].Name"
```
ğŸ“Œ **SprawdÅº, ktÃ³re buckety sÄ… publicznie dostÄ™pne.**  

#**UsuniÄ™cie dostÄ™pu publicznego do bucketa**  
```sh
aws s3api put-public-access-block --bucket my-public-bucket \
    --public-access-block-configuration '{
        "BlockPublicAcls": true,
        "IgnorePublicAcls": true,
        "BlockPublicPolicy": true,
        "RestrictPublicBuckets": true
    }'
```
ğŸ“Œ **Bucket `my-public-bucket` nie jest juÅ¼ dostÄ™pny publicznie.** ğŸ‰  


</details>

---

## **9. Optymalizacja kosztÃ³w w Trusted Advisor**  
- Przejrzyj raporty dotyczÄ…ce niewykorzystanych instancji EC2 i storage S3.  
- Zastosuj zalecenia dotyczÄ…ce oszczÄ™dnoÅ›ci, np. zmniejszenie rozmiaru instancji lub przeniesienie danych do S3 Glacier.  

<details>
    <summary>Instrukcja krok po kroku AWS GUI</summary>

**1. PrzeglÄ…d rekomendacji Trusted Advisor dla optymalizacji kosztÃ³w**  
1. PrzejdÅº do **AWS Management Console** â†’ **Trusted Advisor**.  
2. Wybierz kategoriÄ™ **Cost Optimization**.  
3. Przejrzyj kluczowe rekomendacje, takie jak:  
   - **Underutilized Amazon EC2 Instances** (Nieefektywne instancje EC2).  
   - **Idle Load Balancers** (NieuÅ¼ywane Load Balancery).  
   - **Unassociated Elastic IP Addresses** (Nieprzypisane adresy Elastic IP).  
   - **Low Utilization Amazon EBS Volumes** (NieuÅ¼ywane woluminy EBS).  
   - **Amazon S3 Bucket Lifecycle** (Zalecenia dotyczÄ…ce oszczÄ™dnoÅ›ci na S3).  

---

**2. Optymalizacja instancji EC2**  
1. Kliknij w **Underutilized Amazon EC2 Instances**.  
2. SprawdÅº instancje EC2, ktÃ³re majÄ… niskie uÅ¼ycie CPU i pamiÄ™ci RAM.  
3. OtwÃ³rz **AWS EC2** â†’ **Instances** i zdecyduj, czy moÅ¼esz:  
   - **ZatrzymaÄ‡ instancjÄ™** (jeÅ›li nie jest uÅ¼ywana).  
   - **ZmniejszyÄ‡ typ instancji** (np. z `t3.large` na `t3.medium`).  

ğŸ“Œ **Redukcja kosztÃ³w poprzez zmniejszenie zasobÃ³w EC2!** ğŸ‰  

---

**3. UsuniÄ™cie nieuÅ¼ywanych Load BalancerÃ³w**  
1. Kliknij w **Idle Load Balancers**.  
2. SprawdÅº, ktÃ³re Load Balancery nie obsÅ‚ugujÄ… ruchu.  
3. OtwÃ³rz **AWS EC2** â†’ **Load Balancers** i usuÅ„ zbÄ™dne zasoby.  

ğŸ“Œ **Eliminacja nieuÅ¼ywanych Load BalancerÃ³w obniÅ¼a koszty!**  

---

**4. Optymalizacja przechowywania danych (S3, EBS)**  
1. Kliknij w **Low Utilization Amazon EBS Volumes**.  
2. SprawdÅº, ktÃ³re woluminy EBS majÄ… niski poziom operacji IOPS.  
3. OtwÃ³rz **AWS EC2** â†’ **Volumes** i zdecyduj, czy moÅ¼na:  
   - **UsunÄ…Ä‡ wolumen** (jeÅ›li nie jest podÅ‚Ä…czony).  
   - **ZredukowaÄ‡ rozmiar wolumenu**.  

ğŸ“Œ **ZarzÄ…dzanie przechowywaniem danych pozwala oszczÄ™dzaÄ‡ na EBS i S3!**  

</details>

<details>
    <summary>Instrukcja krok po kroku AWS CLI</summary>

**5. Zastosowanie polityki lifecycle dla Amazon S3**  
1. Kliknij w **Amazon S3 Bucket Lifecycle**.  
2. SprawdÅº, ktÃ³re dane mogÄ… zostaÄ‡ przeniesione do **S3 Glacier**.  
3. OtwÃ³rz **AWS S3** â†’ **Bucket** â†’ **Management** â†’ **Lifecycle rules**.  
4. UtwÃ³rz reguÅ‚Ä™, ktÃ³ra automatycznie przenosi dane starsze niÅ¼ 30 dni do Glacier.  

ğŸ“Œ **Przenoszenie nieaktywnych danych do Glacier znacznie obniÅ¼a koszty!** ğŸ‰  

---

## **ğŸ“Œ RozwiÄ…zanie w AWS CLI**  

**1. Pobranie rekomendacji Trusted Advisor dla kosztÃ³w**  
```sh
aws support describe-trusted-advisor-check-result \
    --check-id e7f47a28-07c5-49db-a204-2f0a79c806c0 \
    --language en
```
ğŸ“Œ **Sprawdzi nieuÅ¼ywane EC2, EBS, Load Balancery i S3.**  

---

**2. Znalezienie nieuÅ¼ywanych instancji EC2**  
```sh
aws ec2 describe-instances --query "Reservations[*].Instances[*].[InstanceId,State.Name,InstanceType,Monitoring.State]"
```
ğŸ“Œ **SprawdÅº, ktÃ³re instancje sÄ… w stanie `stopped` lub majÄ… niski monitoring CPU.**  

#**Zmniejszenie typu instancji**  
```sh
aws ec2 modify-instance-attribute --instance-id i-0123456789abcdef0 --instance-type "t3.medium"
```

ğŸ“Œ **Zmniejszenie instancji obniÅ¼a koszty operacyjne!**  

---

**3. UsuniÄ™cie nieuÅ¼ywanych Load BalancerÃ³w**  
ğŸ“Œ Pobierz listÄ™ Load BalancerÃ³w:  
```sh
aws elb describe-load-balancers --query "LoadBalancerDescriptions[*].LoadBalancerName"
```
ğŸ“Œ UsuÅ„ Load Balancer, jeÅ›li nie obsÅ‚uguje ruchu:  
```sh
aws elb delete-load-balancer --load-balancer-name my-unused-lb
```
ğŸ“Œ **UsuniÄ™cie Load Balancera eliminuje niepotrzebne opÅ‚aty!**  

---

**4. Znalezienie i usuniÄ™cie nieuÅ¼ywanych woluminÃ³w EBS**  
ğŸ“Œ Pobierz listÄ™ niepodÅ‚Ä…czonych wolumenÃ³w EBS:  
```sh
aws ec2 describe-volumes --query "Volumes[?State=='available'].[VolumeId,Size]"
```
ğŸ“Œ UsuÅ„ wolumen EBS, jeÅ›li nie jest uÅ¼ywany:  
```sh
aws ec2 delete-volume --volume-id vol-0123456789abcdef0
```
ğŸ“Œ **NiepÅ‚atne wolumeny EBS nadal generujÄ… koszty â€“ usuwaj je!**  

---

**5. Optymalizacja przechowywania danych w S3**  
ğŸ“Œ Pobierz listÄ™ bucketÃ³w:  
```sh
aws s3api list-buckets --query "Buckets[].Name"
```
ğŸ“Œ UtwÃ³rz politykÄ™ lifecycle dla S3, aby przenosiÄ‡ dane do Glacier:  
```sh
aws s3api put-bucket-lifecycle-configuration --bucket my-data-bucket --lifecycle-configuration '{
    "Rules": [
        {
            "ID": "MoveToGlacier",
            "Prefix": "",
            "Status": "Enabled",
            "Transitions": [
                {
                    "Days": 30,
                    "StorageClass": "GLACIER"
                }
            ]
        }
    ]
}'
```
ğŸ“Œ **Automatyczna archiwizacja danych oszczÄ™dza koszty!** ğŸ‰ 
</details>